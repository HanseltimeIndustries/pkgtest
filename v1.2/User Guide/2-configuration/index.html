
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1-test-types/">
      
      
        <link rel="next" href="../3-environment-vars/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.2">
    
    
      
        <title>Configuration - @hanseltime/pkgtest</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="@hanseltime/pkgtest" class="md-header__button md-logo" aria-label="@hanseltime/pkgtest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            @hanseltime/pkgtest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuration
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/HanseltimeIndustries/pkgtest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Getting%20Started/" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../1-test-types/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Contributing/" class="md-tabs__link">
          
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="@hanseltime/pkgtest" class="md-nav__button md-logo" aria-label="@hanseltime/pkgtest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    @hanseltime/pkgtest
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HanseltimeIndustries/pkgtest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/1-test-bins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing CLI (bin) Entries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Getting%20Started/3-custom-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing Custom Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-test-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rootdir" class="md-nav__link">
    <span class="md-ellipsis">
      rootDir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matchignore" class="md-nav__link">
    <span class="md-ellipsis">
      matchIgnore
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additionaldependencies" class="md-nav__link">
    <span class="md-ellipsis">
      additionalDependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locks" class="md-nav__link">
    <span class="md-ellipsis">
      locks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additionalfiles" class="md-nav__link">
    <span class="md-ellipsis">
      additionalFiles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="additionalFiles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      String interpolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-format" class="md-nav__link">
    <span class="md-ellipsis">
      Simple format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-format" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-entries" class="md-nav__link">
    <span class="md-ellipsis">
      Test Entries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test Entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#an-example-of-multiple-test-entries" class="md-nav__link">
    <span class="md-ellipsis">
      An example of multiple test entries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="An example of multiple test entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-if-we-had-some-bin-commands" class="md-nav__link">
    <span class="md-ellipsis">
      What if we had some bin commands?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-entry-options" class="md-nav__link">
    <span class="md-ellipsis">
      Test Entry Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test Entry Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#packagemanagers" class="md-nav__link">
    <span class="md-ellipsis">
      packageManagers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="packageManagers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple-package-manager-types" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Package Manager Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-package-manager-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Package Manager Configurations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Package Manager Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Example Scenario
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moduletypes" class="md-nav__link">
    <span class="md-ellipsis">
      moduleTypes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additionaldependencies_1" class="md-nav__link">
    <span class="md-ellipsis">
      additionalDependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additionalfiles_1" class="md-nav__link">
    <span class="md-ellipsis">
      additionalFiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filetests" class="md-nav__link">
    <span class="md-ellipsis">
      fileTests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fileTests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testmatch" class="md-nav__link">
    <span class="md-ellipsis">
      testMatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runwith" class="md-nav__link">
    <span class="md-ellipsis">
      runWith
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforms" class="md-nav__link">
    <span class="md-ellipsis">
      transforms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transforms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript" class="md-nav__link">
    <span class="md-ellipsis">
      typescript
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bintests" class="md-nav__link">
    <span class="md-ellipsis">
      binTests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binTests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#per-bin-key-tests" class="md-nav__link">
    <span class="md-ellipsis">
      per bin key tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-environment-vars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-filtering-tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filtering tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-ci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Pkgtest in CI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-dependency-lookup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies of Test Projects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-corepack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Corepack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-pkgtest-clean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pkgtest-clean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../99-design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pkgtest Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/classes/FailFastError/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FailFastError
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/classes/TestFailError/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestFailError
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Enumerations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Enumerations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/ModuleTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ModuleTypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/PkgManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/RunWith/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RunWith
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/TestType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestType
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/findPkgTestProjectsByPrefix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    findPkgTestProjectsByPrefix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/getTempDir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getTempDir
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/getTempProjectDirPrefix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getTempProjectDirPrefix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interfaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/BinTestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinTestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/BinTestEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinTestEntry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/CreateTestProjectInfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CreateTestProjectInfo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/FileTestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileTestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/InstalledTool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InstalledTool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/PkgManagerBaseOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManagerBaseOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/PkgManagerOptionsConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManagerOptionsConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/RunOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RunOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/ScriptTestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptTestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TestConfigEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestConfigEntry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TsNodeRun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TsNodeRun
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TsxRun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TsxRun
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TypescriptOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TypescriptOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/YarnV4Options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YarnV4Options
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Type aliases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Type aliases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AddFileCopyTo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AddFileCopyTo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AddFileMatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AddFileMatch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AddFilePerTestProjectCreate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AddFilePerTestProjectCreate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AdditionalFilesEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdditionalFilesEntry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/IPreserveResourcesFn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPreserveResourcesFn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/PkgManagerOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManagerOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/ToDir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToDir
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Variables
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/variables/DEFAULT_TIMEOUT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DEFAULT TIMEOUT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rootdir" class="md-nav__link">
    <span class="md-ellipsis">
      rootDir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matchignore" class="md-nav__link">
    <span class="md-ellipsis">
      matchIgnore
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additionaldependencies" class="md-nav__link">
    <span class="md-ellipsis">
      additionalDependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locks" class="md-nav__link">
    <span class="md-ellipsis">
      locks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additionalfiles" class="md-nav__link">
    <span class="md-ellipsis">
      additionalFiles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="additionalFiles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      String interpolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-format" class="md-nav__link">
    <span class="md-ellipsis">
      Simple format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-format" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-entries" class="md-nav__link">
    <span class="md-ellipsis">
      Test Entries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test Entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#an-example-of-multiple-test-entries" class="md-nav__link">
    <span class="md-ellipsis">
      An example of multiple test entries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="An example of multiple test entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-if-we-had-some-bin-commands" class="md-nav__link">
    <span class="md-ellipsis">
      What if we had some bin commands?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-entry-options" class="md-nav__link">
    <span class="md-ellipsis">
      Test Entry Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test Entry Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#packagemanagers" class="md-nav__link">
    <span class="md-ellipsis">
      packageManagers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="packageManagers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple-package-manager-types" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Package Manager Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-package-manager-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Package Manager Configurations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Package Manager Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Example Scenario
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moduletypes" class="md-nav__link">
    <span class="md-ellipsis">
      moduleTypes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additionaldependencies_1" class="md-nav__link">
    <span class="md-ellipsis">
      additionalDependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additionalfiles_1" class="md-nav__link">
    <span class="md-ellipsis">
      additionalFiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filetests" class="md-nav__link">
    <span class="md-ellipsis">
      fileTests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fileTests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testmatch" class="md-nav__link">
    <span class="md-ellipsis">
      testMatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runwith" class="md-nav__link">
    <span class="md-ellipsis">
      runWith
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transforms" class="md-nav__link">
    <span class="md-ellipsis">
      transforms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transforms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript" class="md-nav__link">
    <span class="md-ellipsis">
      typescript
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bintests" class="md-nav__link">
    <span class="md-ellipsis">
      binTests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binTests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#per-bin-key-tests" class="md-nav__link">
    <span class="md-ellipsis">
      per bin key tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="configuration">Configuration</h1>
<p><code>pkgtest</code> is mainly configured by a <code>pkgtest.config.[json|js|cjs|mjs|ts]</code> file at the root of the package you want to test.</p>
<p>The following will discuss the main concepts of the configuration file, but you can always check the <a href="../../api/interfaces/TestConfig/">Config interface docs</a>
for a full set of features.</p>
<h2 id="rootdir">rootDir</h2>
<p>This is a relative path to the directory with the <code>pkgtest.config</code> file that limits where any <code>testMatch</code> patterns are applied relatively.  This is
helpful for:</p>
<ol>
<li>reducing time to find tests (by minimizing the number of files to scan)</li>
<li>simplifying testMatch patterns to not have to worry about matching the other files (i.e. *<em>/</em>.ts will only match in the rootDir)</li>
</ol>
<p>Default: <code>./</code></p>
<h2 id="matchignore">matchIgnore</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Isolating your pkgtests to a single directory can negate the need to keep lots of matchIgnores since the folder will presumably only hold the tests you want</p>
</div>
<p>matchIgnore can take a list of glob patterns that will cause <code>pkgtest</code> to skip any search activity.  This is helpful for the same reasons as
<code>rootDir</code>.</p>
<p>Default: <code>**/node_modules/**, **/.yarn/**, **/.git/**</code></p>
<h2 id="additionaldependencies">additionalDependencies</h2>
<p>Additional Dependencies allows you to declare other packages that you want to include in each of the test projects that are created.  At the top level,
this means these dependencies will be added to every test entry (but will be overridden by any explicit <code>additionalDependencies</code> at the test entry level).</p>
<p>This is useful for more complex package test scripts:</p>
<div class="highlight"><span class="filename">pkgtests/test1.ts</span><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">camelCase</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;lodash&#39;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">someCamcelCaseFunc</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@myscope/mypkg&#39;</span>

<span class="nx">someCamelCaseFunc</span><span class="p">(</span><span class="nx">cameCase</span><span class="p">(</span><span class="s1">&#39;special-string&#39;</span><span class="p">))</span>
</code></pre></div>
<p>In that case, we would add:</p>
<div class="highlight"><span class="filename">pkgtest.config.js</span><pre><span></span><code><span class="w">    </span><span class="nx">additionalDependencies</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">lodash</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;^4.17.21&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Remember for typescript files to add the <code>@types/</code> dependency if the library doesn't export its own types.  You will run into typescript compilation
errors about not being able to find declarations if not!</p>
</div>
<h2 id="locks">locks</h2>
<p>The examples in <a href="../../Getting%20Started/">Getting started</a> use <code>locks: false</code> since that is a simpler configuration and is sufficient for running
on your own machine.</p>
<p>The locks configuration, designates how pkgtest handles lock files.  The goal of lock files is for security and repeatability and a good overview
of them can be found <a href="https://www.arahansen.com/the-ultimate-guide-to-yarn-lock-lockfiles/">here</a>.  In a more complete setup, you would actually
want to make sure that every test project you create uses a committed lock file so that it can make sure it runs the same way in CI.</p>
<p>If you can handle the additional process, pkgtest recommends using lockfiles.  You can see the process in <a href="../5-ci/#configuring-lockfiles">Configuring lockfiles</a>.</p>
<h2 id="additionalfiles">additionalFiles</h2>
<p>You can provide a list of additional files that you want installed in the test project.  This is especially useful if you are testing something like
config file lookup (in fact, pkgtest tests itself this way).</p>
<p>When you specify a direct file, that one file is copied to the location specified in the test project.  Otherwise, if you specify a directory,
it is copied recursively starting at the location specified in the test project.</p>
<h3 id="string-interpolation">String interpolation</h3>
<p>To support different project structures, we provide some variables that you can use in your path string.</p>
<p><code>${configDir}</code> - This resolves to the directory where the config file was found</p>
<p><code>${rootDir}</code> - This resolves to the specified rootDir for test match searches etc</p>
<p>By default, any non-absolute file path is resolved to <code>${rootDir}</code> if there is no interpolation detected.</p>
<p>Examples (assuming config is in <code>/usr/project/</code> and rootDir is <code>/usr/project/pkgtest</code>): </p>
<ul>
<li><code>/my/normal/path</code> - This is an absolute lookup so pkgtest just looks for it (note, this has limited utility, we recommend relative paths)</li>
<li><code>${configDir}/my/path</code> - <code>usr/project/my/path</code></li>
<li><code>${rootDir}/my/path</code> - <code>usr/project/pkgtest/my/path</code></li>
<li><code>my/path</code> - <code>usr/project/pkgtest/my/path</code></li>
</ul>
<h3 id="simple-format">Simple format</h3>
<p>In the simplest format, you can just provide the path to your additional files and they will be copied to the root of the test project that is
created.</p>
<h3 id="advanced-format">Advanced format</h3>
<p>If you would like to copy your files to a different directory, you can use the tuple format:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="w"> </span><span class="s1">&#39;my/path&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;inner/folder&#39;</span><span class="w"> </span><span class="p">]</span>
</code></pre></div>
<p>The following format basically says copy the files at <code>my/path</code> to <code>${testProjectFolder}/inner/folder</code>.</p>
<h2 id="test-entries">Test Entries</h2>
<p>If you've read <a href="../../Getting%20Started/">Getting Started</a>, then you will probably have noticed that a single entry in the entries array can
create many Test Suites.  While you technically could create multiple entries to do the same thing as we did in getting started, that would make
your configuration file very repetitive and tedious to update or maintain.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As a general rule of thumb, a test entry is a dividing line along the number of different projects that you would need (i.e. module type + package manger configuration + any transforms or unique file configurations needed).</p>
</div>
<h3 id="an-example-of-multiple-test-entries">An example of multiple test entries</h3>
<p>Normally, a single test entry that uses typescript as a transform and runs Node would be enough to test rendered js.  However,
for the sake of this example, let's say that we had a desire to use .ts files (proving our package works with transpilation) and
then to also use specifically compiled commonjs and es module javascript for some specific testing reason (perhaps typescript won't
transpile a less safe feature in js that we want to support).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">pkgtests/ts/test1.ts</label><label for="__tabbed_1_2">pkgtests/cjs/testSpecial1.js</label><label for="__tabbed_1_3">pkgtests/esm/testSpecial1.js</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>import { func1 } from &#39;@myscope/mypkg&#39;

func1();
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>const { funcSpecial } = require(&#39;@myscope/mypkt&#39;)
// Let&#39;s pretend this is something exotic for cjs
funcSpecial();
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>import { funcSpecial } from &#39;@myscope/mypkg&#39;
// Let&#39;s pretend this is something exotic for esm
funcSpecial();
</code></pre></div>
</div>
</div>
</div>
<p>In this case, we would need 3 test entries since we'll have:</p>
<ul>
<li>one that applies transforms to .ts files</li>
<li>one that runs just commonjs specific files (no transform)</li>
<li>one that runs just esm specific files (no transform)</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">commonjs project</label><label for="__tabbed_2_2">esm project</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><span class="filename">pkgtest.config.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;yarn-v1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;yarn-berry&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;npm&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pnpm&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rootDir</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;pkgtests&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">entries</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>

<span class="w">            </span><span class="nx">fileTests</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ts/**/*.ts&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">runWith</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ts-node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tsx&quot;</span><span class="p">],</span>
<span class="w">                </span><span class="nx">transforms</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">typescript</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^5.0.0&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">tsNode</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^10.9.2&#39;</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="nx">tsx</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^4.19.2&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="nx">nodeTypes</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^20.0.0&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">packageManagers</span><span class="o">:</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="p">,</span>
<span class="w">            </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;esm&quot;</span><span class="p">],</span>

<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fileTests</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cjs/**/*.js&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">runWith</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We can&#39;t run ts-node or tsx since these aren&#39;t ts files</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">packageManagers</span><span class="o">:</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="p">,</span>
<span class="w">            </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;commonjs&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We also don&#39;t want to run commonjs in esm projects so just commonjs</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fileTests</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;esm/**/*.js&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">runWith</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We can&#39;t run ts-node or tsx since these aren&#39;t ts files</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">packageManagers</span><span class="o">:</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="p">,</span>
<span class="w">            </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;esm&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We also don&#39;t want to run esm in commonjs projects so just esm</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">pkgtest.config.js</span><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rootDir</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;pkgtests&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">entries</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>

<span class="w">            </span><span class="nx">fileTests</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ts/**/*.ts&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">runWith</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ts-node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tsx&quot;</span><span class="p">],</span>
<span class="w">                </span><span class="nx">transforms</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">typescript</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^5.0.0&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">tsNode</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^10.9.2&#39;</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="nx">tsx</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^4.19.2&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="nx">nodeTypes</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^20.0.0&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">packageManagers</span><span class="o">:</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="p">,</span>
<span class="w">            </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;esm&quot;</span><span class="p">],</span>

<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fileTests</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cjs/**/*.js&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">runWith</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We can&#39;t run ts-node or tsx since these aren&#39;t ts files</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">packageManagers</span><span class="o">:</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="p">,</span>
<span class="w">            </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;commonjs&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We also don&#39;t want to run commonjs in esm projects so just commonjs</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fileTests</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;esm/**/*.js&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">runWith</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We can&#39;t run ts-node or tsx since these aren&#39;t ts files</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">packageManagers</span><span class="o">:</span><span class="w"> </span><span class="nx">pkgManagers</span><span class="p">,</span>
<span class="w">            </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;esm&quot;</span><span class="p">],</span><span class="w"> </span><span class="c1">// We also don&#39;t want to run esm in commonjs projects so just esm</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h4 id="what-if-we-had-some-bin-commands">What if we had some bin commands?</h4>
<p>The above test configuration covers us wanting to test the programmatic API of our library.  But let's say we also provided some CLI 
commands that used sommething like Clipanion to basically call our programmatic api in target ways.</p>
<p>```json title="package.json
{
    "name": "mypkg",
    "bin": {
        "command1": "dist/bin/command1.js",
        "command2": "dist/bin/command2.js"
    }</p>
<p>}
<div class="highlight"><pre><span></span><code>If you&#39;ve written command line scripts, you have probably run into one or two of the &quot;gotcha&quot; scenarios about tools not running your
perfectly transpiled script (missing hashbangs anyone?).  You also may want to make sure that the cli doesn&#39;t have any commonjs/esm
runtime failures in it, etc.

For any test entry, we can enable testing of the bin scripts within each of the projects that are created by adding the `binTests`
field.

```javascript
{
    rootDir: &#39;pkgtests&#39;,
    entries: [
        {  
            fileTests: {
                testMatch: &quot;ts/**/*.ts&quot;,
                runWith: [&quot;node&quot;, &quot;ts-node&quot;, &quot;tsx&quot;],
                transforms: {
                    typescript: {
                        version: &#39;^5.0.0&#39;,
                        tsNode: {
                            version: &#39;^10.9.2&#39;
                        },
                        tsx: {
                            version: &#39;^4.19.2&#39;,
                        },
                        nodeTypes: {
                            version: &#39;^20.0.0&#39;,
                        } 
                    }
                },
            },
            packageManagers: pkgManagers,
            moduleTypes: [&quot;commonjs&quot;, &quot;esm&quot;],
            binTests: {
                command1: [
                    {
                        args: &#39;--dry-run something&#39;,
                    },
                    {
                        args: &#39;--pretty-print here&#39;,
                        env: {
                            PRETTINESS: super
                        }
                    }
                ]
                // command2 will just be run with the --help default that pkgtest supplies
            }
        },
    // LEAVE THE OTHER CONFIGS ALONE
    ]
}
</code></pre></div></p>
<p>The above modification now means that for every project created by our .ts test files entry, we will run additional tests that
look like:</p>
<ul>
<li><code>&lt;package manager&gt; command1 --dry-run something</code></li>
<li><code>&lt;package manager&gt; command1 --pretty-print here</code></li>
<li>With an environment variable set of <code>PRETTINESS=super</code></li>
<li><code>&lt;package manager&gt; command2 --help</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We only added <code>binTests</code> to the typescript configuration test entry because, in this case, we only cared about running against
a certain set of package managers and module projects.  The subsequent .js test entries were using effectively the same project
and in our case wouldn't affect the script.</p>
<p>In the event that we wanted to test how our script interpreted a tsconfig.json file or the lack of one, then we would have had
a reason to add binTests to the js entries (or make our own).</p>
<p>If we also wanted to test different configuration files for our script, we may have added more entries then as well.</p>
</div>
<h2 id="test-entry-options">Test Entry Options</h2>
<h3 id="packagemanagers">packageManagers</h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p>The number of unique test projects created is <code>packageManagers</code> * <code>moduleTypes</code></p>
<p>The packageManagers field indicates which types of package managers we want to ensure our package works with.  Which means,
installation + running of the given scripts under that package manager's running system (i.e. <code>yarn node script</code>)</p>
<h4 id="simple-package-manager-types">Simple Package Manager Types</h4>
<p>At its simplest, you can specify any of the corresponding strings in the <a href="../../api/enumerations/PkgManager/">PkgManager enum</a> and pkgtest will 
set up a minimal configuration of the latest package manager project.</p>
<p>This generally involves running <code>corepack use &lt;package manager&gt;@latest</code> or in the case of <code>yarn-v1</code>, <code>corepack use yarn@1,x</code>.</p>
<p>This does mean that the package manager's default configuration behavior is tested, which in some cases may not be the full functionality that
you want to test.  (The example given in <a href="../../Getting%20Started/">getting starterd</a> was that yarn plug'n'play is not the same behavior as its
other simpler and less costly <code>nodeLinker</code> modes - which for some might be fine enough when covered via <code>npm</code> and <code>pnpm</code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In general, simple package manager strings will test compatibility with the latest, default configuration of a package manager.
This does mean that there is a <strong>slight</strong> moving target in terms of your testing, since a new bugged release of the package manager
could suddenly cause tests to fail.</p>
<p>It is this package's opinion that you should want that type of functionality so that you can get ahead of failures that might be coming
down the pipeline for your package as a result of package management tooling issues.</p>
</div>
<h4 id="advanced-package-manager-configurations">Advanced Package Manager Configurations</h4>
<p>For each simple package manager type, you can choose to create any number of advanced configurations that look like:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nx">packageManager</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;yarn-berry&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">alias</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;my fixed version config&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;optional fixed version&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Package Manager specific options</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>See <a href="../../api/interfaces/PkgManagerOptionsConfig/">PkgManagerOptionsConfig</a> for the current options api.</p>
<p>The <a href="../../Getting%20Started/">getting-started</a> guide worked through adding an additional entry for <code>yarn berry with a node-modules nodeLinker strategy</code>.
If you'd like the details of that, please take a look there.</p>
<h5 id="example-scenario">Example Scenario</h5>
<p>In addition to adding node-modules linking from getting-started, let's pretend that we work at SomeCompany Industries and that some ambitious engineer set up an entire
toolchain boilerplate around <code>pnpm</code> and ended up adding lots of wrappers that expect very specific features of the <code>9.x</code> version (there's a backlog
ticket somewhere to update the framework to support new APIs but we need to support it until then).</p>
<p>In that case, we want to make sure that our package works within the <code>9.x</code> version of <code>pnpm</code> so that we can avoid debugging other teams' boilerplates
when they use our package.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nx">packageManager</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;pnpm&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">alias</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;pnpm 9.x for internal framework&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;9.x&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div>
<p>Well that was pretty simple!  Now, we're guaranteed to make sure things work with pnpm@9.x anytime we run <code>pkgtest</code>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>The advanced options types are some of the least complete features for <code>pkgtest</code>.  Any suggestions for extending a
particular packageManager's setup options are welcome!  Please submit an issue and maybe a PR if you're ambitous.</p>
</div>
<h3 id="moduletypes">moduleTypes</h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p>The number of unique test projects created is <code>packageManagers</code> * <code>moduleTypes</code></p>
<p>The largest reason for this library actually stems fromk the commonjs to esm compatibility issues that have been around for years.
As a library package publisher, I have been bit by the "it works on my machine" problem many times over because I thought I transpiled something
for ES Modules or CommonJS only to find out that ts-node or node fails at runtime in some exotic way.  (A simple example is that we never
transformed use of <code>__filename</code> to <code>import.meta</code> based lookups or vice versa (node will halt execution immediately in commonjs mode if it sees <code>import.meta</code>)).</p>
<p>If you're trying to support commonjs and esm in your package, then the chances that you have a larger transpilation chain are pretty high.  And as such,
you'll want to make sure that the end transpiled project works nominally in other projects.</p>
<p>The moduleTypes field indicates that we want to set up a project as either a <code>commonjs</code> or <code>esm</code> project and then run the same scripts.  Under the hood,
pkgtest sets up some basic defaults (i.e. running ts-node in a compatible way with esm or setting up typescript to transpile to <code>ESNext</code> module type).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Keep in mind that, if you're not doing transformation via the typescript transform field and are instead importing explicitly written commonjs or
esm javascript files for tests, you will want to make sure that you don't run a <code>commonjs</code> project with <code>esm</code> tests, since that will fail due to
the inherent differences in code.  Please see the Test Entries example above.</p>
</div>
<h3 id="additionaldependencies_1">additionalDependencies</h3>
<p>Adds additional dependencies to the test projects.  This will override any top-level <code>additionalDependencies</code> as well as any tool versions that might
have been explicitly detailed in the test config enntry.</p>
<p>See the top level <code>additionalDependencies</code> for an example use case.</p>
<h3 id="additionalfiles_1">additionalFiles</h3>
<p>This is the same configuration option as the top-level <code>additionalFiles</code>, but only applies files to the current entry.  Please see the top-level
description for a description.</p>
<h3 id="filetests">fileTests</h3>
<p>When supplied, this indicates that pkgtest will be finding actual js/ts test files and executing them as part of the test.  See <a href="../1-test-types/#file-tests">File Tests</a></p>
<h4 id="testmatch">testMatch</h4>
<p>Each test entry will find and copy over all tests within the <code>rootDir</code> that match the glob pattern.</p>
<p>The pattern is relative to the rootDir and is still subject to any <code>matchIgnore</code> patterns.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">rootDir</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pkgtests&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">matchIgnore</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;fixtures/**/*&quot;</span>
<span class="w">    </span><span class="nx">entries</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">testMatch</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;**/*.ts&quot;</span>
<span class="w">            </span><span class="c1">// other options</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
</code></pre></div>
<p>This means that only <code>.ts</code> files within <code>pkgtests</code> will be matched but none within <code>pkgtests/fixtures/</code>.</p>
<div class="highlight"><pre><span></span><code>mypkg/
<span class="w">  </span>pkgtests/
<span class="hll"><span class="w">    </span>test1.ts
</span><span class="w">    </span>someGrouping/
<span class="hll"><span class="w">      </span>test2.ts
</span><span class="hll"><span class="w">      </span>test3.ts
</span><span class="w">    </span>fixtures/
<span class="w">      </span>someConfigfile.ts
<span class="w">  </span>src/
<span class="w">    </span>index.ts
<span class="w">    </span>something.ts
<span class="w">  </span>pkgtest.config.js
<span class="w">  </span>package.json
</code></pre></div>
<h4 id="runwith">runWith</h4>
<p>As alluded to in other discussions, <code>pkgtest</code> aims to verify ways that people might try and run your library.  Currently, the supported runWith options
are <a href="../../api/enumerations/RunWith/">here</a>.</p>
<p>For tools that are typescript based like <code>ts-node</code> and <code>tsx</code>, you will be required to provide a typescript transform object since <code>pkgtest</code> needs
to set up a tsconfig file.</p>
<h4 id="transforms">transforms</h4>
<p>Transforms returns to any transformations to the supplied test file that we expect to do.  Currently, we only support typescript.</p>
<p>If transforms is specified, <code>pkgtest</code> will configure the specified tool and then run the equivalent of a build call for the tool to compile
the code to .js.</p>
<p>Transform works directly with <code>runWith</code>.  If the tool requires the transform (i.e. tsx requires typescript), it will be used directly with the tool that
runs.  If the <code>runWith</code> is something like node, where it actually relies on the output of the transform, then <code>pkgtest</code> will point each <code>node</code> call to 
the approriately compiled file as the result of the transform.</p>
<p>In general, using a typescript transform as part of a single test entry is the recommneded way to go since you can test typescript and transpile it to 
either esm or commonjs for node based tests as well.</p>
<h5 id="typescript">typescript</h5>
<p>The typescript object can be completely empty of fields if desired.  In that case, it will follow the <a href="../6-dependency-lookup/">dependency lookup</a> for
any typescript related libraries.  Just like with the default package manager settings, this type of configuration may result in having a shifting target
for tooling that runs transforms (in regards to different version fields) but might be desirable from a shifting target standpoint.</p>
<p>If you do not have the required dependencies in your package.json for dependency lookup, then you will have to provide at a minimum, those missing
version values here.  This might be desirable if you don't want to pollute your package.json with tools that your project does not want to use.</p>
<p>For instance, if you want to test with <code>ts-node</code> but make the decision to only use <code>tsx</code> for running development scripts in your projects, you would
need to tell <code>pkgtest</code> what version of <code>ts-node</code> to use:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">transforms</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">typescript</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">tsNode</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">version</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;^9.0.0&#39;</span><span class="w"> </span><span class="c1">// Any npm version is allowed here - you can fix it to a specific version if you want to ensure that version works</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>The above configuration means that you don't need to list ts-node in your project's dependencies since it is not a development tool.</p>
<h5 id="config">config</h5>
<p>The config field can be provided to override tsconfig fields.</p>
<div class="admonition warn">
<p class="admonition-title">Warn</p>
<p>If you wish to override something like target, keep in mind that you will need to create multiple test entries since something like <code>ESNext</code>
does not work with a commonjs module.</p>
</div>
<h3 id="bintests">binTests</h3>
<p>When supplied, this indicates that pkgtest will construct tests for every "bin" entry in your package.json.  See <a href="../1-test-types/#bin-tests">Bin Tests</a></p>
<h4 id="per-bin-key-tests">per bin key tests</h4>
<p>You can specify the tests for each bin file by adding a field of the same name as the bin in your <code>package.json</code>.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nx">command1</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;-f someValue&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">args</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;something&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">env</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">SPECIALVAR</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f13b1293.min.js"></script>
      
    
  </body>
</html>