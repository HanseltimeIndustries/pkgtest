
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1-test-bins/">
      
      
        <link rel="next" href="../../User%20Guide/1-test-types/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.2">
    
    
      
        <title>Testing Custom Scenarios - @hanseltime/pkgtest</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#testing-custom-scenarios" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="@hanseltime/pkgtest" class="md-header__button md-logo" aria-label="@hanseltime/pkgtest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            @hanseltime/pkgtest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing Custom Scenarios
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/HanseltimeIndustries/pkgtest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../User%20Guide/1-test-types/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Contributing/" class="md-tabs__link">
          
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="@hanseltime/pkgtest" class="md-nav__button md-logo" aria-label="@hanseltime/pkgtest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    @hanseltime/pkgtest
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HanseltimeIndustries/pkgtest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-test-bins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing CLI (bin) Entries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Testing Custom Scenarios
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Testing Custom Scenarios
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      Example plugin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pkgtest-config" class="md-nav__link">
    <span class="md-ellipsis">
      pkgtest config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pkgtest config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scripttests" class="md-nav__link">
    <span class="md-ellipsis">
      scriptTests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packagemanagers" class="md-nav__link">
    <span class="md-ellipsis">
      PackageManagers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-it" class="md-nav__link">
    <span class="md-ellipsis">
      Running it
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running it">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-the-output" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Script Test Suite
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-test" class="md-nav__link">
    <span class="md-ellipsis">
      Script Test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/1-test-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/2-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/3-environment-vars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/3-filtering-tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filtering tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/4-parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/5-ci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Pkgtest in CI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/6-dependency-lookup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies of Test Projects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/7-corepack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Corepack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/8-pkgtest-clean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pkgtest-clean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/99-design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pkgtest Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/classes/FailFastError/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FailFastError
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/classes/TestFailError/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestFailError
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Enumerations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Enumerations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/ModuleTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ModuleTypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/PkgManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/RunWith/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RunWith
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/enumerations/TestType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestType
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/findPkgTestProjectsByPrefix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    findPkgTestProjectsByPrefix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/getTempDir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getTempDir
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/getTempProjectDirPrefix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getTempProjectDirPrefix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functions/run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interfaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/BinTestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinTestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/BinTestEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BinTestEntry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/CreateTestProjectInfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CreateTestProjectInfo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/FileTestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileTestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/InstalledTool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InstalledTool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/PkgManagerBaseOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManagerBaseOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/PkgManagerOptionsConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManagerOptionsConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/RunOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RunOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/ScriptTestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptTestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TestConfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TestConfigEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestConfigEntry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TsNodeRun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TsNodeRun
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TsxRun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TsxRun
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/TypescriptOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TypescriptOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/interfaces/YarnV4Options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YarnV4Options
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Type aliases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Type aliases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AddFileCopyTo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AddFileCopyTo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AddFileMatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AddFileMatch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AddFilePerTestProjectCreate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AddFilePerTestProjectCreate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/AdditionalFilesEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdditionalFilesEntry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/IPreserveResourcesFn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPreserveResourcesFn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/PkgManagerOptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PkgManagerOptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type-aliases/ToDir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToDir
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Variables
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/variables/DEFAULT_TIMEOUT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DEFAULT TIMEOUT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      Example plugin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pkgtest-config" class="md-nav__link">
    <span class="md-ellipsis">
      pkgtest config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pkgtest config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scripttests" class="md-nav__link">
    <span class="md-ellipsis">
      scriptTests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packagemanagers" class="md-nav__link">
    <span class="md-ellipsis">
      PackageManagers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-it" class="md-nav__link">
    <span class="md-ellipsis">
      Running it
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running it">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-the-output" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Script Test Suite
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-test" class="md-nav__link">
    <span class="md-ellipsis">
      Script Test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="testing-custom-scenarios">Testing Custom Scenarios</h1>
<p>If you were to create a standard npm package, you probably would be happy with file tests as detailed in <a href="../">Getting started</a>
and with any bin tests for any CLI entrypoints that you would define for your package.</p>
<p>However, what if you were building something like a plugin within a framework?</p>
<p>In that case, you would want to know that your plugin works when it is imported into different configured projects and the other tool is
called with a configuration to use your plugin.</p>
<p>In this case, this is where Script Tests come in.</p>
<h2 id="example-plugin">Example plugin</h2>
<p>Let's go ahead and set up a simple yarn berry plugin to illustrate this (adapted from <a href="https://yarnpkg.com/advanced/plugin-tutorial">here</a>):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">package.json</label><label for="__tabbed_1_2">tsconfig.json</label><label for="__tabbed_1_3">src/index.ts</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;yarn-simple-hello&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Say hello&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;lib/index.js&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;moduleResolution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;es2020&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;outDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;lib&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;rootDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;src&quot;</span>
<span class="w">    </span><span class="c1">// Other fields</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Plugin</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@yarnpkg/core&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;yarn-simple-hello&quot;</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">factory</span><span class="p">(</span><span class="nx">require</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">pkg</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">T</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Plugin</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="nx">BaseCommand</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="sb">`@yarnpkg/cli`</span><span class="p">);</span>

<span class="w">    </span><span class="kd">class</span><span class="w"> </span><span class="nx">HelloWorldCommand</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">BaseCommand</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="nx">paths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="sb">`hello`</span><span class="p">]];</span>

<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="nx">execute</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="sb">`This is my very own plugin 😎\n`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">commands</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="nx">HelloWorldCommand</span><span class="p">,</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Unpacking this a little, we have a single typescript file that we will transpile to lib/index.js, which is a yarn berry plugin.
For yarn, you actually need to commit your compiled file and have people point to it to use it (via github's raw view if you're
hosting on github).</p>
<p>Locally, we can use our own transpiled file by setting this in <code>.yarnrc.yml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">plugins</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./lib/index.js</span>
</code></pre></div>
<p>Let's say that, now, you want to verify that your plugin works correctly with yarn-berry in each linker configuration.  And that you
want to run it on CI against different environment (windows, mac, ubuntu).</p>
<h2 id="pkgtest-config">pkgtest config</h2>
<p>To test the hello script that we built, let's set up our <code>pkgtest.config.js</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">commonjs project</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><span class="filename">pkgtest.config.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">join</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">baseYarnrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lib&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index.js&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">nodeLinkedYarnBerry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">alias</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn node linked&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">packageManager</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn-berry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">yarnrc</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">nodeLinker</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;node-modules&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="p">...</span><span class="nx">baseYarnrc</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">pnpmLinkedYarnBerry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">alias</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn pnpm linked&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">packageManager</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn-berry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">yarnrc</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">nodeLinker</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pnpm&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="p">...</span><span class="nx">baseYarnrc</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">pnpLinkedYarnBerry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">alias</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn pnp linked&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">packageManager</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn-berry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">options</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">yarnrc</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">nodeLinker</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pnp&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="p">...</span><span class="nx">baseYarnrc</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">};</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">packageManagers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="nx">nodeLinkedYarnBerry</span><span class="p">,</span>
<span class="w">    </span><span class="nx">pnpLinkedYarnBerry</span><span class="p">,</span>
<span class="w">    </span><span class="nx">pnpmLinkedYarnBerry</span><span class="p">,</span>
<span class="p">];</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rootDir</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pkgtest&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">locks</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">matchIgnore</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;fixtures/**&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nx">entries</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">        </span><span class="nx">scriptTests</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;testHello&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">script</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn hello&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nx">packageManagers</span><span class="p">,</span>
<span class="w">        </span><span class="nx">moduleTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;esm&quot;</span><span class="p">],</span>
<span class="w">        </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="mf">3000</span><span class="p">,</span>
<span class="w">    </span><span class="p">}],</span>
<span class="p">};</span>
</code></pre></div>
</div>
</div>
</div>
<p>Let's unpack the above pkgtest config a bit</p>
<h3 id="scripttests">scriptTests</h3>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">setupTests</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;testHello&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">script</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;yarn hello&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
</code></pre></div>
<p>This section declares that we will:</p>
<ol>
<li>Add a script to each test project's package.json that looks like <code>"testHello": "yarn hello"</code></li>
<li>Run a Script Test Suite that will call <code>&lt;pkg manager&gt; testHello</code> as its sole test in each test project and validate if it exits with a 0</li>
</ol>
<h3 id="packagemanagers">PackageManagers</h3>
<p>Now that we have the ability to call anything, we need to make sure that everything else is inside of the
project before we get to our script test.  In our case, since we already can configure the .yarnrc.yml, we 
just go ahead and configure it with a fully resolved path to our compiled file.</p>
<div class="highlight"><pre><span></span><code>nodeLinker: pnpm
plugins:
    - /full/path/to/pkg/lib/index.js
</code></pre></div>
<h2 id="running-it">Running it</h2>
<p>Let's go ahead and run pkgtest:</p>
<div class="highlight"><pre><span></span><code>yarn<span class="w"> </span>tsc<span class="w">  </span><span class="c1"># Make sure you&#39;ve compiled your bin file</span>
yarn<span class="w"> </span>pkgtest
</code></pre></div>
<p>You should now see some new test suites reported:</p>
<pre>
<code>
...Additional Tests Tests...

Test Suite for Module esm, Package Manager yarn-berry (yarn node linked), Package Scripts
Test package location: /tmp/pkgTest-XXXXXXhgjVy3
Test:  corepack yarn@latest testHello <span style="color:green">Passed</span> 682 ms
        corepack yarn@latest testHello:
Passed: <span style="color:green">1</span>
Failed: <span style="color:red">0</span>
Skipped: 0
Not Run: 0
Total: 1

[runner] File Test Suites:  <span style="color:green">0 passed</span>, 0 total
[runner] File Tests:        <span style="color:green">0 passed</span>, 0 total
[runner] Bin Test Suites:  <span style="color:green">0 passed</span>, 0 total
[runner] Bin Tests:        <span style="color:green">0 passed</span>, 0 total
[runner] Script Test Suites:  <span style="color:green">6 passed</span>, 6 total
[runner] Script Tests:        <span style="color:green">6 passed</span>, 6 total
[runner] Setup Time:       2.131 s
[runner] File Test Time:   0 s
[runner] Bin Test Time:    0 s
[runner] Script Test Time: 3.223 s
</code>
</pre>

<h3 id="understanding-the-output">Understanding the output</h3>
<pre>
<code>
Test Suite for Module esm, Package Manager yarn-berry (yarn node linked), Package Scripts
Test package location: /tmp/pkgTest-XXXXXXhgjVy3
Test:  corepack yarn@latest testHello <span style="color:green">Passed</span> 682 ms
        corepack yarn@latest testHello:
Passed: <span style="color:green">1</span>
Failed: <span style="color:red">0</span>
Skipped: 0
Not Run: 0
Total: 1
</code>
</pre>

<h4 id="script-test-suite">Script Test Suite</h4>
<p>This is the output for a Script Test Suite.  As you can see, a script test suite is the run of all script entries in the <code>scriptTests</code> array
for a given project configured for <code>module type + package manager configuration</code>.  They are denoted by the <code>Package Scripts</code> string.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Try adding another script entry to your package.json and re-run (<code>"testHello2": "yarn hello"</code>).  You should see 2 tests
now in the suite.</p>
</div>
<h4 id="script-test">Script Test</h4>
<pre>
<code>
Test:  corepack yarn@latest testHello <span style="color:green">Passed</span> 682 ms
        corepack yarn@latest testHello:
</code>
</pre>

<p>This one's pretty straight forward.  Each script is considered a test and is run once.  We did that here.
If this were a script that we wanted to run across multiple package managers with different run syntax you would see that reflected
in the test of the respective test suite <code>npm run testHello</code></p>
<h2 id="conclusion">Conclusion</h2>
<p>The above is a fairly bare bones example of setting up a script in test projects.  Hopefully, this can help get your mind running on other set
ups.</p>
<p>As a simple though exercise, if I were to set up an <a href="https://swc.rs">SWC</a> plugin package, I could set up package test with:</p>
<ul>
<li>additionalDependencies for <code>@swc/core</code> <code>@swc/cli</code></li>
<li>additionalFiles of a <code>.swcrc</code>, and a file to transpile</li>
<li>a script test to run <code>swc</code> </li>
<li>Optionally, I could get even fancier and write a quick .js script to read the expected output file and check for certain updates</li>
<li>In that case, this would be another additionalFile and my script might look like <code>swc &amp;&amp; verify.js</code></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f13b1293.min.js"></script>
      
    
  </body>
</html>